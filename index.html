<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Recovery Portal — Demo</title>
  <meta name="description" content="Demo Recovery Portal (educational) — replace placeholders with legitimate backends/payments" />
  <style>
    :root{
      --bg-1: #071021;
      --bg-2: #081622;
      --card: rgba(255,255,255,0.02);
      --muted: #9fb3c8;
      --text: #eaf1f8;
      --accent: #14F195;
      --accent-2: #9945FF;
      --danger: #ff6b6b;
      --glass: rgba(255,255,255,0.03);
      --border: rgba(255,255,255,0.04);
      --radius: 14px;
      --max-width: 520px;
      --ui-gap: 12px;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(160deg,var(--bg-1),var(--bg-2));
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: env(safe-area-inset-top) 16px env(safe-area-inset-bottom);
    }

    .card{
      width:100%;
      max-width:var(--max-width);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:18px;
      box-sizing:border-box;
      box-shadow: 0 8px 30px rgba(0,0,0,0.5);
      -webkit-font-smoothing:antialiased;
    }

    .header{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .brand{ display:flex; gap:10px; align-items:center; }
    .glyph{ width:44px; height:44px; border-radius:10px; background:linear-gradient(135deg,var(--accent-2),var(--accent)); display:flex; align-items:center; justify-content:center; font-weight:800; color:white; }
    h1{ font-size:16px; margin:0; }
    .sub{ color:var(--muted); font-size:13px; margin-top:4px; }

    .main{ margin-top:14px; text-align:center; }
    .welcome{ font-size:15px; font-weight:700; color:var(--accent); }
    .balance{ margin-top:8px; font-size:18px; font-weight:800; }
    .small{ color:var(--muted); font-size:13px; }

    .controls{ display:flex; gap:10px; margin-top:14px; }
    .btn{
      flex:1; padding:12px; border-radius:10px; border:0; cursor:pointer; font-weight:700; color:white;
      background: linear-gradient(135deg,var(--accent-2),var(--accent));
      box-shadow: 0 8px 20px rgba(20,241,149,0.08);
    }
    .btn.ghost{ background:transparent; border:1px solid var(--border); color:var(--text); font-weight:600; }
    .btn.secondary{ background:linear-gradient(135deg,#2b3640,#17303a); }

    /* Panel styles */
    .panel{ margin-top:14px; background:var(--glass); border-radius:12px; padding:12px; border:1px solid rgba(255,255,255,0.02); display:none; }
    .panel.visible{ display:block; }

    .form-row{ display:grid; gap:10px; margin-top:6px; }
    input[type="text"], input[type="number"], select{
      width:100%; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:var(--text);
      font-size:14px; box-sizing:border-box;
    }
    label{ font-size:13px; color:var(--muted); margin-bottom:4px; }

    .laser-area{
      position:relative; height:220px; margin-top:12px; border-radius:10px; overflow:hidden; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.05));
      border:1px solid rgba(255,255,255,0.02);
    }
    .device-screen{
      position:absolute; inset:12px; border-radius:8px; background:linear-gradient(180deg,#071826 0%, #04151c 100%); box-shadow: inset 0 6px 30px rgba(0,0,0,0.6);
      overflow:hidden; display:flex; flex-direction:column; align-items:center; justify-content:center; color:var(--muted);
    }

    /* Laser */
    .laser{
      position:absolute; left:0; right:0; height:6px; background:linear-gradient(90deg, rgba(20,241,149,0.02), rgba(20,241,149,0.9), rgba(20,241,149,0.02));
      box-shadow: 0 0 18px rgba(20,241,149,0.12); transform: translateY(-120%); opacity:0.0;
    }
    @keyframes laser-slide{
      0% { transform: translateY(-120%); opacity:0; }
      5% { opacity:1; }
      95% { opacity:1; }
      100% { transform: translateY(120%); opacity:0; }
    }

    .scan-log{ margin-top:12px; text-align:left; font-size:13px; color:var(--muted); max-height:160px; overflow:auto; padding-right:6px;}
    .scan-log .item{ padding:8px; border-radius:8px; margin-bottom:8px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border:1px solid rgba(255,255,255,0.02); }
    .scan-log .ok{ color:var(--accent); font-weight:700; }
    .recovered{ margin-top:10px; font-size:16px; font-weight:800; color:var(--accent); }

    /* Modal */
    .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,0.6); display:none; align-items:center; justify-content:center; z-index:40; padding:16px; }
    .modal{ width:100%; max-width:420px; background:var(--card); border-radius:12px; padding:16px; border:1px solid var(--border); }
    .modal h3{ margin:0 0 8px 0; }
    .modal p{ margin:0 0 12px 0; color:var(--muted); font-size:13px; }

    .progress-bar{ height:10px; background:rgba(255,255,255,0.03); border-radius:999px; overflow:hidden; margin-top:12px; }
    .progress-fill{ height:100%; width:0%; background: linear-gradient(90deg, rgba(153,69,255,0.9), rgba(20,241,149,0.9)); transition:width 200ms linear; }

    .error{ margin-top:12px; background: rgba(255,92,92,0.08); border:1px solid rgba(255,92,92,0.12); padding:10px; border-radius:8px; color:var(--danger); }

    .disclaimer{ margin-top:12px; font-size:12px; color:var(--muted); }

    @media (max-width:420px){
      .laser-area{ height:180px; }
    }
  </style>
</head>
<body>
  <main class="card" role="main" aria-live="polite">
    <header class="header">
      <div class="brand">
        <div class="glyph" aria-hidden="true">R</div>
        <div>
          <h1>Recovery Portal (Demo)</h1>
          <div class="sub">A safe, local demo — replace placeholders with your backend</div>
        </div>
      </div>
      <div style="text-align:right">
        <div class="small">Status</div>
        <div style="font-weight:700;color:var(--accent);">Demo mode</div>
      </div>
    </header>

    <!-- registration or greeting -->
    <section id="welcomePanel" class="main" style="margin-top:18px;">
      <div id="greeting" style="display:none;">
        <div class="welcome" id="welcomeName">Welcome, User</div>
        <div class="balance" id="dashboardBalance">$0.00</div>
        <div class="small">Available balance</div>

        <div class="controls" style="margin-top:14px;">
          <button class="btn" id="activateBtn">Activate recovery</button>
          <button class="btn ghost" id="withdrawBtn">Withdraw</button>
        </div>
      </div>

      <div id="register" style="display:none;">
        <div style="font-weight:700">Create one-time registration</div>
        <form id="regForm" class="form-row" style="margin-top:10px;">
          <div>
            <label for="username">Choose a display name</label>
            <input id="username" name="username" type="text" placeholder="e.g. Alex" autocomplete="name" />
          </div>
          <div>
            <label for="email">Email (optional)</label>
            <input id="email" name="email" type="text" placeholder="you@example.com" />
          </div>
          <div style="display:flex; gap:10px;">
            <button type="button" class="btn" id="registerBtn">Register</button>
            <button type="button" class="btn ghost" id="regCancel">Cancel</button>
          </div>
          <div class="disclaimer">This demo stores a one-time name locally (localStorage). Replace with secured backend for production.</div>
        </form>
      </div>

      <div id="noAccount" style="display:none;">
        <div style="font-weight:700">Welcome — Please register</div>
        <div class="small" style="margin-top:8px;">This is a one-time registration used to demo the recovery UX on your device.</div>
        <div class="controls" style="margin-top:12px;">
          <button class="btn" id="startRegister">Create account</button>
        </div>
      </div>
    </section>

    <!-- Scan panel -->
    <section id="scanPanel" class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div style="font-weight:700">Recovery Scanner</div>
        <div class="small">Robotic scan — visual demo</div>
      </div>

      <div class="laser-area" aria-hidden="false">
        <div class="device-screen" id="deviceScreen">
          <div style="font-size:13px;color:var(--muted);">Scanning device screen...</div>
          <div style="height:8px"></div>
          <div id="scanStatus" style="font-weight:700;color:var(--accent);">Ready</div>
        </div>
        <div class="laser" id="laserEl" aria-hidden="true"></div>
      </div>

      <div class="scan-log" id="scanLog" aria-live="polite"></div>

      <div style="display:flex;gap:10px;margin-top:12px;">
        <button class="btn" id="claimBtn" disabled>Claim found funds</button>
        <button class="btn ghost" id="closeScan">Close</button>
      </div>
      <div class="disclaimer">This scan is a visual simulation. Integrate secure recovery logic and user consent in production.</div>
    </section>

    <!-- Withdraw modal / overlay -->
    <div class="modal-backdrop" id="modal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal" role="document" aria-labelledby="modalTitle">
        <h3 id="modalTitle">Withdraw funds</h3>
        <p id="modalSubtitle">Choose currency and destination address</p>

        <div id="withdrawForm">
          <label for="currency">Currency</label>
          <select id="currency">
            <option value="btc">BTC</option>
            <option value="usdt">USDT</option>
            <option value="eth">ETH</option>
          </select>

          <label for="destAddr" style="margin-top:8px;">Destination address</label>
          <input id="destAddr" type="text" placeholder="Paste your wallet address" />

          <div style="display:flex;gap:8px;margin-top:12px;">
            <button class="btn" id="confirmWithdraw">Confirm withdraw</button>
            <button class="btn ghost" id="cancelWithdraw">Cancel</button>
          </div>

          <div class="disclaimer" style="margin-top:10px;">
            Important: In production, integrate KYC & anti-fraud checks and use a compliant on-chain/off-chain payout provider.
          </div>
        </div>

        <div id="loadingBox" style="display:none;">
          <div style="font-weight:700">Processing withdrawal</div>
          <div class="progress-bar"><div class="progress-fill" id="loadingFill"></div></div>
          <div style="display:flex;justify-content:space-between;margin-top:8px;color:var(--muted);font-size:13px;">
            <div id="loadingText">Starting…</div>
            <div id="loadingPct">0%</div>
          </div>
        </div>

        <div id="errorBox" style="display:none;">
          <div class="error">Withdraw failed: A service verification fee of <strong>$750</strong> is required to proceed.</div>
          <p class="small" style="margin-top:8px;">This is a placeholder; do not send funds to unknown addresses. Integrate a secure checkout or contact support to complete legitimate service payments.</p>
          <div style="display:flex;gap:8px;margin-top:10px;">
            <a class="btn" id="payBtn" href="https://example.com/checkout" target="_blank" rel="noopener noreferrer">Open secure checkout</a>
            <button class="btn ghost" id="contactSupport">Contact support</button>
          </div>
        </div>
      </div>
    </div>

    <div id="noticeBottom" style="margin-top:14px; font-size:13px; color:var(--muted);">
      Demo notes: This page is a local UI prototype. Replace any placeholders with legitimate, compliant back-end logic, payment processors, and legal text before production.
    </div>
  </main>

  <script>
    // Demo app logic (safe, client-only)
    (function () {
      // Elements
      const startRegister = document.getElementById('startRegister');
      const register = document.getElementById('register');
      const registerBtn = document.getElementById('registerBtn');
      const regForm = document.getElementById('regForm');
      const usernameInput = document.getElementById('username');
      const emailInput = document.getElementById('email');
      const greetingPanel = document.getElementById('greeting');
      const noAccount = document.getElementById('noAccount');
      const welcomeName = document.getElementById('welcomeName');
      const dashboardBalance = document.getElementById('dashboardBalance');
      const activateBtn = document.getElementById('activateBtn');
      const withdrawBtn = document.getElementById('withdrawBtn');
      const scanPanel = document.getElementById('scanPanel');
      const laserEl = document.getElementById('laserEl');
      const scanLog = document.getElementById('scanLog');
      const deviceScreen = document.getElementById('deviceScreen');
      const scanStatus = document.getElementById('scanStatus');
      const claimBtn = document.getElementById('claimBtn');
      const closeScan = document.getElementById('closeScan');
      const modal = document.getElementById('modal');
      const confirmWithdraw = document.getElementById('confirmWithdraw');
      const cancelWithdraw = document.getElementById('cancelWithdraw');
      const loadingBox = document.getElementById('loadingBox');
      const withdrawForm = document.getElementById('withdrawForm');
      const loadingFill = document.getElementById('loadingFill');
      const loadingText = document.getElementById('loadingText');
      const loadingPct = document.getElementById('loadingPct');
      const errorBox = document.getElementById('errorBox');
      const payBtn = document.getElementById('payBtn');
      const contactSupport = document.getElementById('contactSupport');

      // Init: check localStorage for user
      let user = JSON.parse(localStorage.getItem('demo_recovery_user') || 'null');
      let balance = Number(localStorage.getItem('demo_recovery_balance') || '0');

      function showRegistration() {
        register.style.display = 'block';
        greetingPanel.style.display = 'none';
        noAccount.style.display = 'none';
      }
      function showWelcome() {
        register.style.display = 'none';
        greetingPanel.style.display = 'block';
        noAccount.style.display = 'none';
        welcomeName.textContent = `Welcome, ${user.displayName}`;
        dashboardBalance.textContent = formatMoney(balance);
      }
      function showNoAccount() {
        register.style.display = 'none';
        greetingPanel.style.display = 'none';
        noAccount.style.display = 'block';
      }
      function formatMoney(n){
        return '$' + n.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
      }

      if (!user) {
        showNoAccount();
      } else {
        showWelcome();
      }

      // Start register
      document.getElementById('startRegister')?.addEventListener('click', () => {
        showRegistration();
        usernameInput.focus();
      });

      registerBtn.addEventListener('click', () => {
        const name = usernameInput.value.trim();
        if (!name) { alert('Please enter a display name.'); return; }
        user = { displayName: name, email: emailInput.value.trim() || '' };
        localStorage.setItem('demo_recovery_user', JSON.stringify(user));
        // initialize balance in demo (zero)
        balance = Number(localStorage.getItem('demo_recovery_balance') || '0');
        localStorage.setItem('demo_recovery_balance', String(balance));
        showWelcome();
      });

      document.getElementById('regCancel')?.addEventListener('click', () => {
        if (user) showWelcome(); else showNoAccount();
      });

      // Activate recovery -> run scan animation 6 times
      activateBtn.addEventListener('click', () => {
        if (!user) { alert('Please register first.'); return; }
        scanLog.innerHTML = '';
        scanPanel.classList.add('visible');
        claimBtn.disabled = true;
        runScanAnimation(6)
          .then(() => simulateRoboticReview())
          .then((foundAmount) => {
            // show recovered amount and enable claim
            const recEl = document.createElement('div');
            recEl.className = 'recovered';
            recEl.textContent = `Total found recovery: ${formatMoney(foundAmount)}`;
            scanLog.appendChild(recEl);
            claimBtn.disabled = false;
            // store found amount in a temporary variable for claim
            scanPanel.dataset.found = String(foundAmount);
          })
          .catch(err => {
            console.error(err);
            scanLog.appendChild(createLogItem('Scan aborted or failed', ''));
          });
      });

      function createLogItem(text, cls = '') {
        const el = document.createElement('div');
        el.className = 'item';
        el.textContent = text;
        if (cls) el.classList.add(cls);
        return el;
      }

      function runScanAnimation(iterations = 6) {
        return new Promise((resolve) => {
          // Set up CSS animation parameters dynamically
          laserEl.style.animation = `laser-slide 700ms linear ${iterations}`;
          // Ensure the laser is visible
          laserEl.style.opacity = '0';
          // Clear previous logs
          scanLog.appendChild(createLogItem('Initializing scanner...'));
          scanStatus.textContent = 'Scanning';
          // Listen for animationend
          let ended = false;
          const onEnd = (ev) => {
            // some browsers fire multiple animationend events; guard
            if (ended) return;
            ended = true;
            laserEl.removeEventListener('animationend', onEnd);
            laserEl.style.animation = '';
            scanStatus.textContent = 'Scan complete';
            scanLog.appendChild(createLogItem('Scan passes completed', 'ok'));
            resolve();
          };
          // small delay before starting
          setTimeout(() => {
            laserEl.addEventListener('animationend', onEnd);
            // start animation by setting opacity and letting keyframes move translateY
            laserEl.style.opacity = '1';
            // animation will run
          }, 150);
        });
      }

      function simulateRoboticReview() {
        // Add staged robotic messages, then resolve with found amount
        return new Promise((resolve) => {
          const steps = [
            'Analyzing screen artifacts...',
            'Decoding potential recovery traces...',
            'Cross-checking with local cache...',
            'Decrypting partial entries...',
            'Validating recoverable amounts...',
            'Finalizing results...'
          ];
          let idx = 0;
          function next() {
            if (idx < steps.length) {
              const msg = createLogItem(steps[idx]);
              scanLog.appendChild(msg);
              scanLog.scrollTop = scanLog.scrollHeight;
              idx++;
              setTimeout(next, 800 + Math.random()*400);
            } else {
              // final ’robotic review' messages
              scanLog.appendChild(createLogItem('Robotic review: no malware detected', 'ok'));
              scanLog.appendChild(createLogItem('Recovery candidate confidence: high', 'ok'));
              // Simulated found amount (as requested)
              const found = 45000;
              setTimeout(() => resolve(found), 600);
            }
          }
          next();
        });
      }

      claimBtn.addEventListener('click', () => {
        // Add found amount to dashboard balance (demo)
        const found = Number(scanPanel.dataset.found || '0');
        if (found <= 0) return;
        balance = Number(balance) + Number(found);
        localStorage.setItem('demo_recovery_balance', String(balance));
        dashboardBalance.textContent = formatMoney(balance);
        // Disable claim to avoid double claiming in demo
        claimBtn.disabled = true;
        scanLog.appendChild(createLogItem('Claim completed — amount added to dashboard', 'ok'));
      });

      closeScan.addEventListener('click', () => {
        scanPanel.classList.remove('visible');
      });

      // Withdraw flow: open modal
      withdrawBtn.addEventListener('click', () => {
        if (!user) { alert('Please register to withdraw.'); return; }
        // Basic check: must have positive balance
        if (balance <= 0) { alert('No available balance to withdraw.'); return; }
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden', 'false');
        // reset modal state
        withdrawForm.style.display = 'block';
        loadingBox.style.display = 'none';
        errorBox.style.display = 'none';
        loadingFill.style.width = '0%';
        loadingPct.textContent = '0%';
        loadingText.textContent = 'Starting…';
      });

      cancelWithdraw.addEventListener('click', () => {
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
      });

      confirmWithdraw.addEventListener('click', () => {
        const dest = document.getElementById('destAddr').value.trim();
        const currency = document.getElementById('currency').value;
        if (!dest) { alert('Please enter destination address.'); return; }

        // For demo: hide form, show loading for 25 seconds then show error
        withdrawForm.style.display = 'none';
        loadingBox.style.display = 'block';
        errorBox.style.display = 'none';

        const totalMs = 25000;
        const start = Date.now();
        function tick(){
          const elapsed = Date.now() - start;
          let pct = Math.min(100, Math.round((elapsed / totalMs) * 100));
          loadingFill.style.width = pct + '%';
          loadingPct.textContent = pct + '%';
          loadingText.textContent = pct < 100 ? 'Processing…' : 'Finalizing…';
          if (pct < 100) {
            requestAnimationFrame(tick);
          } else {
            // After loading, show an error about required fee (placeholder)
            setTimeout(() => {
              loadingBox.style.display = 'none';
              errorBox.style.display = 'block';
            }, 300);
          }
        }
        requestAnimationFrame(tick);
      });

      // Pay / support actions (placeholders)
      contactSupport.addEventListener('click', () => {
        window.open('mailto:support@example.com?subject=Recovery%20Portal%20Support', '_blank', 'noopener');
      });

      // Accessibility: escape closes modal
      window.addEventListener('keydown', (ev) => {
        if (ev.key === 'Escape') {
          if (modal.style.display === 'flex') {
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
          } else if (scanPanel.classList.contains('visible')) {
            scanPanel.classList.remove('visible');
          }
        }
      });

      // Small helper: clear any animation on load to avoid glitches
      window.addEventListener('load', () => {
        laserEl.style.animation = '';
      });

    }());
  </script>
</body>
</html>
